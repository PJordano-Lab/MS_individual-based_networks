Estimation of modularity and nestedness metrics
================
Blanca Arroyo-Correa
7/17/2023

# Load packages

``` r
library(bipartite)
library(here)
library(tidyverse)
library(magrittr)
```

# Read data

``` r
# ind-sp
nets_names <- list.files(path = here("networks/standardized/"), pattern = "_int")
nets <- list()

for (i in 1:length(nets_names)){
  net_file <- paste0("networks/standardized/", nets_names[[i]])
  net <- read.csv(here(net_file))
  
  if(ncol(net)<2){
    net <- read.csv(here(net_file), sep = ";") 
  } else
  {}  

  net %<>% column_to_rownames("ind")
  nets[[i]] <- net #add to list
  names(nets)[i] <- nets_names[[i]]

}


# sp-sp
nets_names_sp <- list.files(path = here("networks/standardized/"), pattern = "stsp_")
nets_sp <- list()

for (i in 1:length(nets_names_sp)){
  net_file <- paste0("networks/standardized/", nets_names_sp[[i]])
  net <- read.csv(here(net_file))
  
  if(ncol(net)<2){
    net <- read.csv(here(net_file), sep = ";") 
  } else
  {}  

  net %<>% column_to_rownames("sp")
  nets_sp[[i]] <- net #add to list
  names(nets_sp)[i] <- nets_names_sp[[i]]

}

# test rounding interactions in network
net.test <- nets[c(20)]
for (i in seq_along(net.test)){
  temp <- net.test[[i]]
  temp2 <- round(temp*100,0)
  net.test[[i]] <- temp2
}
```

# Modularity calculation

``` r
# only modularity without z-scores
# individual-based networks
mod.info <- data.frame(matrix(ncol = 2, nrow = length(nets)))
x <- c("network", "M")
colnames(mod.info) <- x

total = length(nets)

pb = txtProgressBar(min = 0, max = total, initial = 0, title = "Progress Bar", label="0% done", style=3) 
```

    ##   |                                                                            |                                                                    |   0%

``` r
for(i in 1:length(nets)){
  mod.info$network[i] <- names(nets[i])
  
  # modularity (M) computation
  mod <-computeModules(nets[[i]])
  mod.info$M[i] <- mod@likelihood
  
  setTxtProgressBar(pb,i)
}
```

    ##   |                                                                            |=                                                                   |   2%  |                                                                            |===                                                                 |   4%  |                                                                            |====                                                                |   6%  |                                                                            |======                                                              |   8%  |                                                                            |=======                                                             |  10%  |                                                                            |========                                                            |  12%  |                                                                            |==========                                                          |  15%  |                                                                            |===========                                                         |  17%  |                                                                            |=============                                                       |  19%  |                                                                            |==============                                                      |  21%  |                                                                            |================                                                    |  23%  |                                                                            |=================                                                   |  25%  |                                                                            |==================                                                  |  27%  |                                                                            |====================                                                |  29%  |                                                                            |=====================                                               |  31%  |                                                                            |=======================                                             |  33%  |                                                                            |========================                                            |  35%  |                                                                            |==========================                                          |  38%  |                                                                            |===========================                                         |  40%  |                                                                            |============================                                        |  42%  |                                                                            |==============================                                      |  44%  |                                                                            |===============================                                     |  46%  |                                                                            |=================================                                   |  48%  |                                                                            |==================================                                  |  50%  |                                                                            |===================================                                 |  52%  |                                                                            |=====================================                               |  54%  |                                                                            |======================================                              |  56%  |                                                                            |========================================                            |  58%  |                                                                            |=========================================                           |  60%  |                                                                            |==========================================                          |  62%  |                                                                            |============================================                        |  65%  |                                                                            |=============================================                       |  67%  |                                                                            |===============================================                     |  69%  |                                                                            |================================================                    |  71%  |                                                                            |==================================================                  |  73%  |                                                                            |===================================================                 |  75%  |                                                                            |====================================================                |  77%  |                                                                            |======================================================              |  79%  |                                                                            |=======================================================             |  81%  |                                                                            |=========================================================           |  83%  |                                                                            |==========================================================          |  85%  |                                                                            |============================================================        |  88%  |                                                                            |=============================================================       |  90%  |                                                                            |==============================================================      |  92%  |                                                                            |================================================================    |  94%  |                                                                            |=================================================================   |  96%  |                                                                            |=================================================================== |  98%  |                                                                            |====================================================================| 100%

``` r
write.csv(mod.info, here("data/modularity_estimation_gts.csv"))
```

``` r
# species-based networks
mod.info.sp <- data.frame(matrix(ncol = 2, nrow = length(nets_sp)))
x <- c("network", "M")
colnames(mod.info.sp) <- x

total = length(nets_sp)

pb = txtProgressBar(min = 0, max = total, initial = 0, title = "Progress Bar", label="0% done", style=3) 
```

    ##   |                                                                            |                                                                    |   0%

``` r
for(i in 1:length(nets_sp)){
  mod.info.sp$network[i] <- names(nets_sp[i])
  
  # modularity (M) computation
  mod <-computeModules(nets_sp[[i]])
  mod.info.sp$M[i] <- mod@likelihood
  
  setTxtProgressBar(pb,i)
}
```

    ##   |                                                                            |=                                                                   |   1%  |                                                                            |==                                                                  |   3%  |                                                                            |===                                                                 |   4%  |                                                                            |====                                                                |   6%  |                                                                            |=====                                                               |   7%  |                                                                            |======                                                              |   9%  |                                                                            |=======                                                             |  10%  |                                                                            |========                                                            |  12%  |                                                                            |=========                                                           |  13%  |                                                                            |==========                                                          |  15%  |                                                                            |===========                                                         |  16%  |                                                                            |============                                                        |  18%  |                                                                            |=============                                                       |  19%  |                                                                            |==============                                                      |  21%  |                                                                            |===============                                                     |  22%  |                                                                            |================                                                    |  24%  |                                                                            |=================                                                   |  25%  |                                                                            |==================                                                  |  26%  |                                                                            |===================                                                 |  28%  |                                                                            |====================                                                |  29%  |                                                                            |=====================                                               |  31%  |                                                                            |======================                                              |  32%  |                                                                            |=======================                                             |  34%  |                                                                            |========================                                            |  35%  |                                                                            |=========================                                           |  37%  |                                                                            |==========================                                          |  38%  |                                                                            |===========================                                         |  40%  |                                                                            |============================                                        |  41%  |                                                                            |=============================                                       |  43%  |                                                                            |==============================                                      |  44%  |                                                                            |===============================                                     |  46%  |                                                                            |================================                                    |  47%  |                                                                            |=================================                                   |  49%  |                                                                            |==================================                                  |  50%  |                                                                            |===================================                                 |  51%  |                                                                            |====================================                                |  53%  |                                                                            |=====================================                               |  54%  |                                                                            |======================================                              |  56%  |                                                                            |=======================================                             |  57%  |                                                                            |========================================                            |  59%  |                                                                            |=========================================                           |  60%  |                                                                            |==========================================                          |  62%  |                                                                            |===========================================                         |  63%  |                                                                            |============================================                        |  65%  |                                                                            |=============================================                       |  66%  |                                                                            |==============================================                      |  68%  |                                                                            |===============================================                     |  69%  |                                                                            |================================================                    |  71%  |                                                                            |=================================================                   |  72%  |                                                                            |==================================================                  |  74%  |                                                                            |===================================================                 |  75%  |                                                                            |====================================================                |  76%  |                                                                            |=====================================================               |  78%  |                                                                            |======================================================              |  79%  |                                                                            |=======================================================             |  81%  |                                                                            |========================================================            |  82%  |                                                                            |=========================================================           |  84%  |                                                                            |==========================================================          |  85%  |                                                                            |===========================================================         |  87%  |                                                                            |============================================================        |  88%  |                                                                            |=============================================================       |  90%  |                                                                            |==============================================================      |  91%  |                                                                            |===============================================================     |  93%  |                                                                            |================================================================    |  94%  |                                                                            |=================================================================   |  96%  |                                                                            |==================================================================  |  97%  |                                                                            |=================================================================== |  99%  |                                                                            |====================================================================| 100%

``` r
getwd()
```

    ## [1] "/Users/Elena/Documents/PROJECTS/MS_individual-based_networks/analysis"

``` r
write.csv(mod.info.sp, here("data/modularity_estimation_gts_sp.csv"))
```
